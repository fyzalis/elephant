$(document).ready(function(){!function(t){t.fn.elephant=function(e){function n(){g=i(localStorage.getItem("elephant"))}function a(){I(),f.active&&(f.time++,w())}function r(){1==f.favorite?(f.favorite=0,w()):(f.favorite=1,S(!0))}function o(t){return JSON.stringify(t)}function i(t){return jQuery.parseJSON(t)}var c=t.extend({triggers:new Array,activeDuration:30},e),u=window.location.pathname,l={page:u,text:"",image:""},g=new Array,f={time:0,scroll:0,visit:0,trigger:0,favorite:0,updated_at:new Date,active:!0,score:0},s={time:1,scroll:1,visit:10,trigger:10},h=new Array,p=function(){return null!=localStorage.getItem("elephant")},v=function(){localStorage.setItem("elephant",o(g))},m=function(t){return i(localStorage.getItem("elephant::"+t))},d=function(t){for(var e in t)t.hasOwnProperty(e)&&(f[e]="updated_at"!=e?t[e]:new Date(t[e]))},w=function(){A(),localStorage.setItem("elephant::"+u,o(f))},y=function(){S(!0),f.trigger+=1,w()},S=function(t){t&&(f.updated_at=new Date),f.active=t,w()},I=function(){var t=new Date,e=f.updated_at.getTime()/1e3,n=t.getTime()/1e3;Math.round(n-e)>c.activeDuration&&1==f.active&&S(!1)},A=function(){var t=0;t+=Math.round(f.time*s.time),t+=Math.round(f.visit*s.visit),t+=Math.round(f.trigger*s.trigger),t+=Math.round(f.scroll*s.scroll),f.score=t,D()},D=function(){var e=(new Array,new Array),n=new Array,a=0;t.each(g,function(t,a){var r=new Array;r.page=a,r.stats=m(g[t]),r.stats.favorite?e.push(r):n.push(r)}),e.sort(function(t,e){return e.stats.score-t.stats.score}),n.sort(function(t,e){return e.stats.score-t.stats.score}),t.each(e,function(t,e){h[a]=e.page,a++}),t.each(n,function(t,e){h[a]=e.page,a++})};(function(){return!!t("div#elephant").length})()&&(p()||v(),n(),function(){return-1!==jQuery.inArray(u,g)}()||function(){g.push(u),localStorage.setItem("elephant",o(g)),localStorage.setItem("elephant::"+u,o(f)),l.text=t("#elephant").data("text"),l.image=t("#elephant").data("image"),localStorage.setItem("elephanto::"+u,o(l))}(),function(){var t=i(localStorage.getItem("elephant::"+u));d(t)}(),setInterval(function(){a()},1e3),function(){t(window).scroll(function(t){S(!0),f.scroll+=1,w()})}(),function(){f.visit+=1,S(!0),w()}(),function(){t.each(c.triggers,function(e,n){t(n).on("click",function(){y()})})}(),function(){t("#elephantAdd").on("click",function(){r(),w()})}()),function(){return!!t("div#elephanto").length}()&&(p()||v(),n(),D(),function(){var e="";e+="<ul>",t.each(h,function(t,n){var a=i(localStorage.getItem("elephanto::"+n)),r=i(localStorage.getItem("elephant::"+n));e+="<li>",e+="<a href='"+a.page+"'>",e+=a.text,e+="</a> (score :"+r.score+")(favorite : "+r.favorite+")<br />",e+="<img src='"+a.image+"' style='width:30px;' />",r.favorite&&(e+="<img src='/star-icon.png' />"),e+="<hr />",e+="</li>"}),e+="</ul>",t("#elephanto").html(e)}())}}(jQuery)}),$(document).ready(function(){$.fn.elephant({triggers:new Array(".trigger1",".trigger2"),activeDuration:5})});